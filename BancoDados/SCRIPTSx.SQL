/******************************************************************************/
/****         Generated by IBExpert 2008.08.08 22/02/2018 07:31:48         ****/
/******************************************************************************/

/******************************************************************************/
/****                               Domains                                ****/
/******************************************************************************/



/******************************************************************************/
/****                              Generators                              ****/
/******************************************************************************/

CREATE GENERATOR GEN_ABASTECIMENTO_ID;
CREATE GENERATOR GEN_BOMBA_ID;
CREATE GENERATOR GEN_COMBUSTIVEL_ID;
/******************************************************************************/
/****                              Exceptions                              ****/
/******************************************************************************/

/******************************************************************************/
/****                              Procedures                              ****/
/******************************************************************************/

SET TERM ^ ;

SET TERM ; ^



/******************************************************************************/
/****                           Tables and Views                           ****/
/******************************************************************************/

CREATE TABLE ABASTECIMENTO (
    ID_ABASTECIMENTO INTEGER NOT NULL,
    DATA_ABASTECIMENTO TIMESTAMP,
    LITROS_ABASTECIMENTO NUMERIC(5,2),
    VALOR_ABASTECIMENTO DOUBLE PRECISION,
    IMPOSTO_ABASTECIMENTO DOUBLE PRECISION,
    BOMBA_ABASTECIMENTO NUMERIC(2,0) NOT NULL);


CREATE TABLE BOMBA (
    ID_BOMBA NUMERIC(2,0) NOT NULL,
    DESC_BOMBA VARCHAR(20) CHARACTER SET ISO8859_1 COLLATE ISO8859_1,
    TANQUE_BOMBA NUMERIC(1,0),
    COMBUSTIVEL_BOMBA NUMERIC(2,0) NOT NULL);


CREATE TABLE COMBUSTIVEL (
    ID_COMBUSTIVEL NUMERIC(2,0) NOT NULL,
    DESC_COMBUSTIVEL VARCHAR(20) CHARACTER SET ISO8859_1 COLLATE ISO8859_1,
    PRECO_COMBUSTIVEL DOUBLE PRECISION);




/******************************************************************************/
/****                             Primary keys                             ****/
/******************************************************************************/


ALTER TABLE ABASTECIMENTO ADD CONSTRAINT PK_ABASTECIMENTO PRIMARY KEY (ID_ABASTECIMENTO);
ALTER TABLE BOMBA ADD CONSTRAINT PK_BOMBA PRIMARY KEY (ID_BOMBA);
ALTER TABLE COMBUSTIVEL ADD CONSTRAINT PK_COMBUSTIVEL PRIMARY KEY (ID_COMBUSTIVEL);

/******************************************************************************/
/****                          Unique constraints                          ****/
/******************************************************************************/


ALTER TABLE BOMBA ADD CONSTRAINT UNIQUEBOMBA UNIQUE (DESC_BOMBA);
ALTER TABLE COMBUSTIVEL ADD CONSTRAINT UNIQUECOMBUSTIVEL UNIQUE (DESC_COMBUSTIVEL);

/******************************************************************************/
/****                             Foreign keys                             ****/
/******************************************************************************/


ALTER TABLE ABASTECIMENTO ADD CONSTRAINT FK_ABASTECIMENTO_1 FOREIGN KEY (BOMBA_ABASTECIMENTO) REFERENCES BOMBA (ID_BOMBA);
ALTER TABLE BOMBA ADD CONSTRAINT FK_BOMBA_1 FOREIGN KEY (COMBUSTIVEL_BOMBA) REFERENCES COMBUSTIVEL (ID_COMBUSTIVEL);

/******************************************************************************/
/****                          Check constraints                           ****/
/******************************************************************************/



/******************************************************************************/
/****                               Indices                                ****/
/******************************************************************************/


CREATE INDEX IND_DATABASTECIMENTO ON ABASTECIMENTO (DATA_ABASTECIMENTO);
CREATE INDEX IND_PKABASTECIMENTO ON ABASTECIMENTO (ID_ABASTECIMENTO);
CREATE INDEX IND_PKBOMBA ON BOMBA (ID_BOMBA);
CREATE INDEX IND_UNIQUE ON BOMBA (DESC_BOMBA);
CREATE INDEX IND_PKCOMBUSTIVEL ON COMBUSTIVEL (ID_COMBUSTIVEL);
CREATE INDEX IND_UNIQUECOMBUS ON COMBUSTIVEL (DESC_COMBUSTIVEL);

/******************************************************************************/
/****                               Triggers                               ****/
/******************************************************************************/

SET TERM ^ ;

CREATE TRIGGER ABASTECIMENTO_BI FOR ABASTECIMENTO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_ABASTECIMENTO IS NULL) THEN
    NEW.ID_ABASTECIMENTO = GEN_ID(GEN_ABASTECIMENTO_ID,1);
END
^

CREATE TRIGGER BOMBA_BI FOR BOMBA
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_BOMBA IS NULL) THEN
    NEW.ID_BOMBA = GEN_ID(GEN_BOMBA_ID,1);
END
^

CREATE TRIGGER COMBUSTIVEL_BI FOR COMBUSTIVEL
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_COMBUSTIVEL IS NULL) THEN
    NEW.ID_COMBUSTIVEL = GEN_ID(GEN_COMBUSTIVEL_ID,1);
END
^

SET TERM ; ^

/******************************************************************************/
/****                              Procedures                              ****/
/******************************************************************************/

SET TERM ^ ;

SET TERM ; ^

